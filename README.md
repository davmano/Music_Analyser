# Magic Patterns - Vite Template

This code was generated by [Magic Patterns](https://magicpatterns.com) for this design: [Source Design](https://www.magicpatterns.com/c/mwy9x47mvwgx1btoqt9gjh)

## Getting Started

1. Run `npm install`
2. Run `npm run dev`

# 🎵 Music Analyzer - DevOps Roadmap

This repository demonstrates how to take a modern React/Vite app from development to production using full DevOps principles: containerization, Kubernetes, EKS, GitOps, monitoring, logging, and security.

---

## 🛠️ DevOpsification Roadmap

We DevOpsify the app in structured phases:

### ✅ Phase 1: Dockerize the React App

* Wrote a multi-stage `Dockerfile` (Node 18 build + Nginx serve)
* Added `.dockerignore`
* Built and tested locally:

  ```bash
  docker build -t davmano/music-analyzer:v1 .
  docker run -d -p 8080:80 music-analyzer
  ```

  Access: `http://localhost:8080`

### ✅ Phase 2: Kubernetes Deployment (Dev Clusters)

* Created `k8s/` folder with:

  * `deployment.yaml`
  * `service.yaml`
  * `ingress.yaml` (optional)
* Tested using Kind (or Minikube):

  ```bash
  kind create cluster --name analyzer-cluster
  kubectl apply -f k8s/
  kubectl get pods
  ```

### ✅ Phase 3: EKS Deployment with Terraform

* Used `eks-simple/` folder with:

  * `main.tf`, `outputs.tf`, `providers.tf`, `variables.tf`
* Provisioned EKS via:

  ```bash
  terraform init
  terraform apply -auto-approve
  ```
* Connected to EKS:

  ```bash
  aws eks update-kubeconfig --region us-east-1 --name music-analyzer-eks
  kubectl get nodes
  ```

### ✅ Phase 4: Continuous Integration (CI) with GitHub Actions

* CI pipeline in `.github/workflows/ci.yaml`:

  * Builds Docker image `davmano/music-analyzer:v1`
  * Pushes to Docker Hub
  * Updates `k8s/deployment.yaml` with new image tag
  * Pushes change back to GitHub using SSH deploy key

### ✅ Phase 5: Continuous Delivery (CD) with ArgoCD

* Installed ArgoCD in the EKS cluster
* Created `k8s/argocd/music-analyzer-app.yaml`:

  ```yaml
  spec:
    source:
      repoURL: https://github.com/davmano/Music_Analyser
      targetRevision: main
      path: k8s
    destination:
      server: https://kubernetes.default.svc
      namespace: music-analyzer
    syncPolicy:
      automated:
        selfHeal: true
        prune: true
  ```
* ArgoCD watches Git repo and syncs changes automatically
* Supports GitOps: Git = single source of truth
* Self-heals drifted resources

### ✅ Phase 6: Monitoring with Prometheus & Grafana

* Installed kube-prometheus-stack via Helm:

  ```bash
  helm repo add prometheus-community https://prometheus-community.github.io/helm-charts
  helm install kube-monitoring prometheus-community/kube-prometheus-stack --namespace monitoring
  ```
* Access Grafana:

  ```bash
  kubectl port-forward -n monitoring svc/kube-monitoring-grafana 3000:80
  ```
* Access Prometheus:

  ```bash
  kubectl port-forward -n monitoring svc/kube-monitoring-prometheus 9090
  ```

### ✅ Phase 7: Security Scanning with Trivy

* Added Trivy scan step to GitHub Actions:

  ```yaml
  - name: Trivy Scan
    uses: aquasecurity/trivy-action@master
    with:
      image-ref: davmano/music-analyzer:v1
      scan-type: image
  ```
* Scans Docker image for CVEs during CI build

---

## 🌐 Live Access (EKS + NGINX Ingress)

* Installed ingress controller:

  ```bash
  kubectl apply -f https://raw.githubusercontent.com/kubernetes/ingress-nginx/controller-v1.10.1/deploy/static/provider/aws/deploy.yaml
  ```
* Access app at:

  ```
  http://<your-ingress-lb>.amazonaws.com
  ```

---

## 📁 Folder Structure

```
Music_Analyser/
├── Dockerfile
├── k8s/
│   ├── deployment.yaml
│   ├── service.yaml
│   ├── ingress.yaml
│   └── argocd/
│       └── music-analyzer-app.yaml
    └── config/
│        └── aws-auth.yaml
├── terraform                👈 Terraform files for EKS, VPC, etc.
    ├── main.tf
│   ├── variables.tf
│   ├── outputs.tf
│   └── provider.tf
├── .github/
│   └── workflows/ci.yaml
├── README.md
└── .dockerignore

```

---

## 🚀 Summary

| Phase              | Tools Used            |
| ------------------ | --------------------- |
| Containerization   | Docker                |
| Deployment         | Kubernetes (Kind/EKS) |
| Infra Provisioning | Terraform             |
| CI                 | GitHub Actions        |
| CD (GitOps)        | ArgoCD                |
| Monitoring         | Prometheus + Grafana  |
| Security           | Trivy                 |

---

## 📈 Next Steps

* Add centralized logging with Loki or EFK
* Enable HTTPS with cert-manager + Let's Encrypt
* Add custom metrics export for Prometheus
* Implement Argo Rollouts for progressive delivery

---

## 🌐 Maintained by David Mano

* GitHub: [@davmano](https://github.com/davmano)
* Email: [davmano51@gmail.com](mailto:davmano51@gmail.com)
